# Architecture

At first glance, the structure of the CMMV project, with its interconnected modules and orchestrated components, may seem complex. However, we will break down each element below to clarify its function within the application.

<img src="/assets/cmmv-core.png" />

# Core

The Core serves as the orchestrator of the entire system. It contains fundamental classes required for system operation, such as Singleton, Application, and other essential utilities. Additionally, it provides everything necessary for the creation of contracts. Through the Core, it is possible to configure the application and integrate complementary modules, transpilers, providers, and services, among other components.

When the application starts, the first process is to load all configured modules and submodules in the system. This includes their services, additional configurations, validation settings, and most importantly, transpilers. Transpilers play a crucial role in the system, generating system files based on contracts, views, and forms.

The application only requires the Core module to function. For microservices, additional modules may not be necessary. However, without other modules, the application would only be capable of executing tasks directly applied via code. This is why the module system is so important.

Additionally, the application is responsible for creating models, interfaces, and schemas for fast-json-stringify, as well as DTOs. These data structures are used for automatic typing, input data validation with class-validator, data transformation and serialization, and high-performance JSON parsing using `fast-json-stringify`.

# HTTP 

The HTTP module is responsible for:

* Creating services and controllers for basic CRUD operations

* Handling data validation, exporting data, and applying filters

* Exposing a RESTful API

By default, the HTTP module uses `@cmmv/server` as an abstraction layer for handling requests and serving files. However, it can be replaced with Express or other frameworks.

The HTTP module includes built-in support for:

* ETag caching

* Compression

* Security headers (Helmet)

* Input validation for JSON data

* Cookie handling

* Static file serving

* CORS (Cross-Origin Resource Sharing)

* Session management

# Repository (Optional) 

The Repository module is fundamental for any application as it provides an abstraction layer for `TypeORM`. It manages the communication between the application and the database while supporting:

* SQLite

* MongoDB

* SQL Server

* MySQL

* PostgreSQL

* Oracle

This module is responsible for generating ORM entities, indexes, and relationships in relational databases. Additionally, services previously generated by the HTTP module will be updated to fetch data directly from the database, eliminating the need for additional integrations.

# Cache (Optional)

The Cache module complements HTTP and RPC by providing an in-memory caching layer for the server. It can be easily applied to controllers and gateways through decorators.

The Cache module supports:

* Redis

* Memcached

* MongoDB

* Binary file storage

It leverages `cache-manager` for its functionality. Cache settings can be configured directly in contracts, with options for TTL (time-to-live), compression, and key prefixing.

## Protobuf (Optional)

CMMV natively supports **RPC**, and for this, the **Protobuf module** is responsible for generating contracts in the `.proto` standard. It also creates **interfaces and types** for TypeScript usage and a **JSON structure** to support Protobuf in the frontend when communication occurs via RPC.

Additionally, the **`@cmmv/vue` module** integrates Protobuf with **Vue 2 and Vue 3**, providing **mixins and composables** for easy implementation. This module also configures **binary WebSocket communication**, ensuring seamless integration between backend and frontend.

## WebSocket (Optional)

For efficient RPC communication with **low overhead**, the **WebSocket module** handles **bidirectional binary data transmission** based on contracts. As previously mentioned, all frontend implementations are structured around **contracts**, which can be used in two ways:

- **Importing the generated JavaScript bundle**, which simplifies contract-based interactions.
- **Using the `@cmmv/vue` module**, which provides a streamlined approach for integrating WebSocket-based communication in Vue applications.

This modular structure ensures that RPC calls are optimized for **performance, scalability, and ease of use**, allowing for lightweight real-time communication.

## Auth (Optional)

The **Auth module** is responsible for managing system access, providing **secure local authentication** with encrypted usernames and passwords. It also supports **third-party authentication** via providers such as **Google, Facebook, and others**.

- **User authentication & registration**
- **Role-based access control (RBAC)**
- **Permission groups for fine-grained authorization**
- **Automatic integration with controllers and gateways** for private route protection
- **Access token generation & management**
- **OAuth support for seamless third-party authentication**
- **Works with both RESTful and RPC communication** without requiring additional implementations

This module ensures a **secure and scalable authentication system**, simplifying the process of user management while providing robust security measures.

## Official CMMV Modules

Beyond its core functionality, CMMV provides **official modules** that extend its capabilities for various use cases. These modules cover areas such as **form schema creation, frontend UI components, task scheduling, testing, server-side rendering (SSR), message queues, search, encryption, API documentation, and event-driven communication**.

### Available Modules:

<br/>

- **`@cmmv/form`** - Generates **schemas for dashboards** and dynamic form elements.
- **`@cmmv/ui`** - Provides **Vue 3-based frontend components** for building **admin panels** and pages.
- **`@cmmv/scheduling`** - Supports **predefined job scheduling** routines.
- **`@cmmv/testing`** - Enables **automated testing** for CMMV applications.
- **`@cmmv/view`** - Provides **basic Server-Side Rendering (SSR)** capabilities.
- **`@cmmv/queue`** - Implements **task queues** with support for **Redis, RabbitMQ, and Kafka**.
- **`@cmmv/elastic`** - Integrates **Elasticsearch** for **full-text search** functionality.
- **`@cmmv/email`** - Handles **email delivery** with built-in configuration.
- **`@cmmv/normalizer`** - Supports **data normalization** for **JSON, XML, and CSV** formats.
- **`@cmmv/encryptor`** - Provides **advanced encryption** and **digital signatures using elliptic curves**.
- **`@cmmv/swagger`** - Generates **API documentation** automatically.
- **`@cmmv/events`** - Implements **internal event-driven communication** for microservices and modules.
- **`@cmmv/vue`** - Seamlessly integrates **Vue 2 and Vue 3** with CMMV applications.

These modules offer **plug-and-play enhancements**, allowing developers to **extend** their applications without additional complexity. Whether for UI development, background processing, security, or inter-service communication, the **CMMV ecosystem** provides **modular** and **scalable** solutions for modern applications.